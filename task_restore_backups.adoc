---
sidebar: sidebar
permalink: task_restore_backups.html
keywords: restoring, restore, restore volumes, restore files, Backup to Cloud, cloud backup service, single file restore
summary: Backups are stored in an object store in your cloud account so that you can restore data from a specific point in time. You can restore an entire volume from a saved backup file, or if you only need to restore a few files, you can restore up to 8 individual files (at one time) from a saved backup file.
---

= Restoring volume data from backup files
:hardbreaks:
:nofooter:
:icons: font
:linkattrs:
:imagesdir: ./media/

[.lead]
Backups are stored in an object store in your cloud account so that you can restore data from a specific point in time. You can restore an entire volume from a saved backup file, or if you only need to restore a few files, you can restore up to 8 individual files (at one time) from a saved backup file.

_Restoring an entire volume_ is part of the Backup to Cloud service that you used to create the backup file. Once you have activated the Backup to Cloud service in a working environment, you can restore an entire volume in the same working environment, or to a different working environment, that's using the same cloud account. See <<Restoring a volume from a backup,Restoring a volume from a backup>>.

_Restoring individual files_ from a backup file actually uses two services. It uses the Backup to Cloud service to create the backup file just like described above. But when you initiate a single file restore it uses the Restore service to restore the files. You can restore files to a volume in the same working environment, or to a volume in a different working environment, that's using the same cloud account. You can also restore files to a volume on an on-premises ONTAP system. See <<Restoring files from a backup,Restoring files from a backup>>.

== Restoring a volume from a backup

When you restore a volume from a backup file, Cloud Manager creates a _new_ volume using the data from the backup. You can restore the data to a volume in the same working environment or to a different working environment that's located in the same cloud account as the source working environment.

=== Supported Working Environments

You can restore a volume from a backup file to the following working environments:

[cols=2*,options="header",cols="30,40",width="90%"]
|===

| Backup File Location
| Restore Working Environment

| Amazon S3 | Cloud Volumes ONTAP in AWS
| Azure Blob | Cloud Volumes ONTAP in Azure
| Google Cloud Storage | Cloud Volumes ONTAP in Google

|===

.Steps

. From and Canvas, select the working environment.

. From the Services panel, click image:screenshot_gallery_options.gif[More icon] and select *View Backups*.
+
image:screenshot_view_backups_selection.png[A screenshot of selecting the View Backups button for a working environment.]

. Select the row for the volume that you want to restore and click *View Backup List*.
+
image:screenshot_backup_to_s3_volume.gif[A screenshot of the Backup and Restore tab showing a volume that has backups.]

. Find the backup that you want to restore based on the date/time stamp and click the *Restore* icon.
+
image:screenshot_backup_to_s3_restore_icon.gif[A screenshot of the restore icon for a backup after you select a volume.]

. Fill out the _Restore Backup to new volume_ page:
.. Select the working environment.
.. Enter a name for the volume.
.. Click *Restore*.
+
image:screenshot_backup_to_s3_restore_options.gif[A screenshot that shows the destination restore options: a working environment, a volume, and the volume info.]

.Result

Cloud Manager creates a new volume based on the backup you selected and you are directed to that working environment so you can view the restore progress. You can link:task_managing_storage.html#managing-existing-volumes[manage this new volume^] as required.

== Restoring files from a backup

If you only need to restore a few files from a volume, you can choose to restore individual files instead of restoring the entire volume. Restoring individual files from a backup file uses the Restore service. You can restore files to a volume in the same working environment, or to a different working environment, that's using the same cloud account. You can also restore files to an on-premises ONTAP system.

You can restore up to 8 files at a time from a volume in a backup file. If you need to restore more than 8 files you can run the restore process a second time. All the files are restored to the same destination volume that you choose.

=== Supported Working Environments

You can restore individual files from a backup file to the following working environments:

[cols=2*,options="header",cols="30,40",width="90%"]
|===

| Backup File Location
| Restore Working Environment

| Amazon S3 | Cloud Volumes ONTAP in AWS
 On-premises ONTAP system
| Azure Blob | Cloud Volumes ONTAP in Azure
On-premises ONTAP system

|===

=== Single File Restore process

The process goes like this:

. You enable the Restore service from the Services panel and you are directed to the Restore page under the Restore tab.

. When you want to restore one or more files from a volume, select the Restore tab and select the backup file (the snapshot) where the file resides.
+
The Restore instance starts up and displays the folders and files that exist within the backup file.
+
Note that a Restore instance is deployed in your cloud providers' environment the first time you attempt to restore a file.

. You choose the file (or up to 8 files) from that backup, select the location where you want the file(s) to be written (the working environment, volume, and folder), and click Restore.
+
The Restore instance restores the file(s), and then the instance is shut down to save costs after a period of inactivity.

=== Details

.Costs

See link:concept_backup_to_cloud.html#cost[this topic^] for the cost of both the Backup to Cloud service and the Restore service.

.Instance type

* In AWS, the Restore instance runs on an https://aws.amazon.com/ec2/instance-types/m5/[m5n.xlarge instance^] with 4 CPUs, 16 GiB Memory, and EBS Only instance storage. In regions where m5n.xlarge instance isnâ€™t available, Restore runs on an m5.xlarge instance instead.

* In Azure, the Restore virtual machine runs on a https://docs.microsoft.com/en-us/azure/virtual-machines/dv3-dsv3-series#dsv3-series[Standard_D4s_v3 VM^] with 4 CPUs, 16 GiB Memory, and a 32 GB disk.

.AWS permissions required

When using the Restore service with AWS, the IAM role that provides Cloud Manager with permissions must include S3 permissions from the latest https://mysupport.netapp.com/site/info/cloud-manager-policies[Cloud Manager policy^] as described in link:task_backup_to_s3.html#requirements[AWS requirements^].

Additionally, the following permissions are needed in the policy for single file restore:

[source,json]
  "Action": [
    "ec2:DescribeInstanceTypeOfferings",
    "ec2:startInstances",
    "ec2:stopInstances",
    "ec2:terminateInstances"
  ],

.Access

The Restore instance requires outbound internet access to manage resources and processes within your public cloud environment.

=== Enabling the Restore service

This is a one-time operation per working environment.

NOTE: The Backup to Cloud service must already be activated for this working environment.

.Steps

. From and Canvas, select the working environment.

. Click the *Enable* button for the Restore service.
+
image:screenshot_restore_activate_button.png[A screenshot of the Enable button to enable the single file restore functionality.]

You are directed to the Restore page under the Restore tab.

=== Restoring a single file from a backup file

Follow these steps to restore up to 8 files from a volume backup to a volume. You should know the date of the backup file you want to use to restore the file, or files. This functionality uses Live Browsing so that you can view the current list of directories and files within the backup file.

Note that the wording in the UI calls each backup file a "snapshot" because backup files are created using NetApp Snapshot technology.

The following video shows a quick walkthrough of restoring a single file:

video::ROAY6gPL9N0[youtube, width=848, height=480]

NOTE: The ONTAP version must be 9.6 or greater in your source and destination ONTAP systems.

.Steps

. Click the *Restore* tab.
+
The Restore Dashboard appears.
+
image:screenshot_restore_inventory_page.png[A screenshot of the Restore inventory page that shows all restore operations that have completed. It also shows the Restore Files button.]

. Click the *Restore Files* button.

. In the _Select Source_ page, select the *Working Environment*, the *Volume*, and the *Snapshot* that has the date/time stamp from which you want to restore files.
+
image:screenshot_restore_select_source.png[A screenshot of selecting the volume and snapshot for the files you want to restore.]

. Click *Continue* and the Restore instance is started. After a few minutes the Restore instance displays the list of folders and files from the volume snapshot.
+
Note that a Restore instance is deployed in your cloud providers' environment the first time you restore a file and that this step could take a few minutes longer the first time.
+
image:screenshot_restore_select_files.png[A screenshot of the Select Files page so you can navigate to the files you want to restore.]

. In the _Select Files_ page, select the file or files that you want to restore and click *Continue*.
* You can click the search icon and enter the name of the file to navigate directly to the file.
* You can click the file name if you see it.
* You can navigate down levels in folders using the image:button_subfolder.png[] button at the end of the row to find the file.
+
As you select files they are added to the left side of the page so you can see the files that you have already chosen. You can remove a file from this list if needed by clicking the *x* next to the file name.

. In the _Select Destination_ page, select the *Working Environment*.
+
image:screenshot_restore_select_work_env.png[A screenshot of selecting the destination working environment for the files you want to restore.]
+
If you select an on-premises cluster and you haven't already configured the cluster connection to the object storage, you are prompted for additional information:
+
* When restoring from Amazon S3, enter IPspace in the ONTAP cluster where the destination volumes reside, and the AWS Access Key and Secret Key needed to access the backup file.
* When restoring from Azure Blob, enter the IPspace in the ONTAP cluster where the destination volumes reside.

. Then select the *Volume* and the *Folder* where you want to restore the files.
+
image:screenshot_restore_select_dest.png[A screenshot of selecting the volume and folder for the files you want to restore.]
+
You have a few options for the location when restoring files.

+
* When you have chosen *Select Target Folder*, as shown above:
+
** You can select any folder.
** You can hover over a folder and click image:button_subfolder.png[] at the end of the row to drill down into subfolders, and then select a folder.

+
* If you have selected the same Working Environment and Volume as the source file (as identified by the image:button_source.png[] icon), you can select *Maintain Source Folder Path* to restore the file, or all files, to the same folder where they existed in the source structure. All the same folders and sub-folders must exist; folders are not created.

. Click *Restore* and you are returned to the Restore Dashboard so you can see the progress of the restore operation.

The Restore instance is shut down after a certain period of inactivity to save you money so that you incur costs only when the Restore instance is active.
